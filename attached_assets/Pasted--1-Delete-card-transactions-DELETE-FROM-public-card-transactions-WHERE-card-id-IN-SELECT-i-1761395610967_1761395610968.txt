-- 1Ô∏è‚É£ Delete card transactions
DELETE FROM public.card_transactions
WHERE card_id IN (
    SELECT id FROM public.cards WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca'
);

-- 2Ô∏è‚É£ Delete card activity logs
DELETE FROM public.card_activity_log
WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 3Ô∏è‚É£ Delete cards
DELETE FROM public.cards
WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 4Ô∏è‚É£ Delete card applications
DELETE FROM public.card_applications
WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 5Ô∏è‚É£ Delete Zelle transactions
DELETE FROM public.zelle_transactions
WHERE sender_id = 'f6017868-af40-4337-98b9-90d6b57395ca'
   OR recipient_user_id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 6Ô∏è‚É£ Delete Zelle settings
DELETE FROM public.zelle_settings
WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 7Ô∏è‚É£ Delete Zelle contacts
DELETE FROM public.zelle_contacts
WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 8Ô∏è‚É£ Delete loan payments
DELETE FROM public.loan_payments
WHERE loan_id IN (
    SELECT id FROM public.loans WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca'
);

-- 9Ô∏è‚É£ Delete loans
DELETE FROM public.loans
WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- üîü Delete transactions referencing accounts
DELETE FROM public.transactions
WHERE account_id IN (
    SELECT id FROM public.accounts WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca'
);

-- 1Ô∏è‚É£1Ô∏è‚É£ Delete accounts
DELETE FROM public.accounts
WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 1Ô∏è‚É£2Ô∏è‚É£ Delete enrollments
DELETE FROM public.enrollments
WHERE application_id IN (
    SELECT id FROM public.applications WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca'
);

-- 1Ô∏è‚É£3Ô∏è‚É£ Delete applications
DELETE FROM public.applications
WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 1Ô∏è‚É£4Ô∏è‚É£ Delete profiles
DELETE FROM public.profiles
WHERE id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 1Ô∏è‚É£5Ô∏è‚É£ Delete notifications
DELETE FROM public.notifications
WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 1Ô∏è‚É£6Ô∏è‚É£ Delete beneficiaries
DELETE FROM public.beneficiaries
WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 1Ô∏è‚É£7Ô∏è‚É£ Delete audit logs
DELETE FROM public.audit_logs
WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 1Ô∏è‚É£8Ô∏è‚É£ Delete system logs
DELETE FROM public.system_logs
WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca'
   OR admin_id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 1Ô∏è‚É£9Ô∏è‚É£ Delete staff entries
DELETE FROM public.staff
WHERE id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 2Ô∏è‚É£0Ô∏è‚É£ Delete Plaid accounts/items
DELETE FROM public.plaid_accounts
WHERE plaid_item_id IN (
    SELECT id FROM public.plaid_items WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca'
);
DELETE FROM public.plaid_items
WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 2Ô∏è‚É£1Ô∏è‚É£ Delete password reset OTPs
DELETE FROM public.password_reset_otps
WHERE email IN (
    SELECT email FROM public.profiles WHERE id = 'f6017868-af40-4337-98b9-90d6b57395ca'
);

-- 2Ô∏è‚É£2Ô∏è‚É£ Delete from email queue
DELETE FROM public.email_queue
WHERE user_id = 'f6017868-af40-4337-98b9-90d6b57395ca';

-- 2Ô∏è‚É£3Ô∏è‚É£ Finally, delete the auth user
DELETE FROM auth.users
WHERE id = 'f6017868-af40-4337-98b9-90d6b57395ca';